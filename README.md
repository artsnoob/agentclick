# CLI AI Agent with gpt-4o-mini (via OpenRouter) and Code Execution

This project is a Python-based Command Line Interface (CLI) AI agent that:
1.  Communicates with OpenAI's `gpt-4o-mini` model (or other compatible models) through the OpenRouter API.
2.  Engages in conversational interactions with the user.
3.  Can generate code snippets based on user requests.
4.  **Allows for the execution of generated code after explicit user confirmation.**

**Built with:** Python, `openai` library, `click` library.

## ‚ú® Core Features

*   **Interactive Chat:** Engage in a back-and-forth conversation with the AI.
*   **OpenRouter Integration:** Leverages OpenRouter to access various LLMs, configured for `gpt-4o-mini` by default.
*   **Streaming Responses:** AI responses are streamed token-by-token for a more dynamic experience.
*   **Code Generation:** Ask the AI to write scripts (e.g., Python, shell).
*   **Code Execution (with Confirmation):**
    *   Detects code blocks in the AI's response.
    *   Displays the code to the user.
    *   **Requires explicit user confirmation before attempting to run any code.**
*   **Conversation History:** Maintains context throughout the session.
*   **Single Prompt Mode:** Option to send a single prompt and get a response without entering interactive mode.

## ‚ö†Ô∏è **CRITICAL SECURITY WARNING: CODE EXECUTION** ‚ö†Ô∏è

This agent includes a feature to execute code generated by the AI. **Running AI-generated code directly can be EXTREMELY DANGEROUS.** The AI might produce malicious, erroneous, or system-damaging code.

*   The current implementation uses Python's `subprocess` module for execution, which **DOES NOT PROVIDE SANDBOXING**. Code runs with the same permissions as the agent script itself.
*   **ALWAYS REVIEW CODE CAREFULLY BEFORE CONFIRMING EXECUTION.**
*   For any use beyond personal, controlled experimentation, you **MUST implement robust sandboxing** (e.g., using Docker containers, virtual machines, or other restricted environments) to isolate code execution.
*   **USE THIS FEATURE AT YOUR OWN RISK.** The author(s) are not responsible for any damage caused by executed code.

## üìã Prerequisites

*   Python 3.8+
*   `pip` (Python package installer)
*   An OpenRouter API Key

## üöÄ Setup & Installation

1.  **Save the Script:**
    Save the Python code for the agent as a `.py` file (e.g., `cli_agent.py`).

2.  **Create a Virtual Environment (Recommended):**
    ```bash
    python -m venv venv
    ```
    Activate it:
    *   Windows (PowerShell): `.\venv\Scripts\Activate.ps1`
    *   Windows (Git Bash/CMD): `.\venv\Scripts\activate`
    *   macOS/Linux: `source venv/bin/activate`

3.  **Install Dependencies:**
    ```bash
    pip install openai click
    ```
    *(If you have a `requirements.txt` file, you can use `pip install -r requirements.txt`)*

4.  **Set Environment Variable for API Key:**
    You need to set your OpenRouter API key as an environment variable named `OPENROUTER_API_KEY`.

    *   **Linux/macOS (bash/zsh):**
        ```bash
        export OPENROUTER_API_KEY="your_openrouter_api_key_here"
        ```
        (Add this to your `~/.bashrc`, `~/.zshrc`, or `~/.profile` for persistence across sessions)

    *   **Windows (PowerShell - current session):**
        ```powershell
        $env:OPENROUTER_API_KEY="your_openrouter_api_key_here"
        ```

    *   **Windows (PowerShell - permanent for user):**
        ```powershell
        [System.Environment]::SetEnvironmentVariable("OPENROUTER_API_KEY", "your_openrouter_api_key_here", "User")
        ```
        *(Close and reopen PowerShell after running this for it to take effect)*

    *   **Windows (Command Prompt - current session):**
        ```cmd
        set OPENROUTER_API_KEY=your_openrouter_api_key_here
        ```

## üíª Usage

1.  **Run the Agent (Interactive Mode):**
    Navigate to the directory where you saved `cli_agent.py` and run:
    ```bash
    python cli_agent.py
    ```
    You can then start typing your prompts. Type `exit` or `quit` to end the session.

2.  **Run the Agent (Single Prompt Mode):**
    To send a single prompt and get a response without entering interactive mode:
    ```bash
    python cli_agent.py -p "Your prompt for the AI here"
    ```
    Example:
    ```bash
    python cli_agent.py -p "write a python script to list all .txt files in the current directory"
    ```

3.  **Code Execution:**
    *   If the AI responds with a code block, it will be displayed.
    *   The agent will then ask if you want to execute each detected code block.
    *   Type `y` or `yes` to confirm, or `n` or `no` to skip.
    *   **Review the code carefully before confirming!**
    *   The output (or error) from the execution will be displayed.

## ‚öôÔ∏è Configuration (Inside `cli_agent.py`)

You can modify the following variables directly in the `cli_agent.py` script:

*   `MODEL_NAME`: Change to use a different model available on OpenRouter (e.g., `"openai/gpt-4o"` for the full GPT-4o model, check OpenRouter for available model IDs).
*   `OPENROUTER_BASE_URL`: The base URL for the OpenRouter API.
*   `YOUR_SITE_URL`, `YOUR_APP_NAME`: Optional headers to help OpenRouter identify your application.
*   System Prompt in `conversation_history`: You can modify the initial system message to change the AI's persona or instructions.

## üí° Future Improvements & TODOs

*   **üîí Implement Robust Sandboxing:** This is the highest priority for safe code execution (e.g., Docker integration).
*   **File System Access:** Securely allow the AI to read from or write to specific files/directories (with user permission).
*   **Tool Use Framework:** Integrate a more formal tool-use system (e.g., LangChain's agents) for more complex tasks.
*   **Persistent Conversation History:** Save and load conversation history across sessions.
*   **Configuration File:** Move API keys and other configurations to a separate config file instead of hardcoding or relying solely on environment variables for some settings.
*   **Enhanced Error Handling:** More granular error reporting and recovery.
*   **Support for More Code Languages:** Extend `execute_code` for other common scripting languages.
*   **Unit Tests:** Add tests for various components.

## ü§ù Contributing

Contributions are welcome! If you have ideas for improvements or bug fixes, please feel free to:
1.  Fork the repository (if this becomes a public project).
2.  Create a new branch (`git checkout -b feature/your-feature-name`).
3.  Make your changes.
4.  Commit your changes (`git commit -am 'Add some feature'`).
5.  Push to the branch (`git push origin feature/your-feature-name`).
6.  Create a new Pull Request.

## üìú License

(Consider adding a license, e.g., MIT License)
